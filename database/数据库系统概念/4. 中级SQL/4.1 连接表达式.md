# 4.1 连接表达式
## 4.1.1 自然连接
两个关系的模式中都出现的属性上，取值相等的元组对。'笛卡尔积'是将第一个关系中的每个元组，与第二个关系的所有元组分别进行串联。
```sql
insert into student(id, name, dept_name,tot_cred) values(001, 'hanjialiang', 'iot', 98), (002, 'xuebichao', 'iot', 97), (003, 'xiayiyou', 'sw', 98);
insert into takes(id, course_id, sec_id, semester, year, grade)values(001, 'cs-101', 1, 'fall', 2017, 'A'), (001, 'cs-347', 1, 'fall', 2017, 'A-'),(002, 'cs-101', 1, 'fall', 2017, 'C'), (003, 'cs-190', 2,'spring', 2017, 'A');
dbsysgn=# select name, course_id from student cross join takes;  // 笛卡尔积
    name     | course_id
-------------+-----------
 hanjialiang | cs-101
 xuebichao   | cs-101
 xiayiyou    | cs-101
 hanjialiang | cs-347
 xuebichao   | cs-347
 xiayiyou    | cs-347
 hanjialiang | cs-101
 xuebichao   | cs-101
 xiayiyou    | cs-101
 hanjialiang | cs-190
 xuebichao   | cs-190
 xiayiyou    | cs-190
(12 行记录)
dbsysgn=# select name, course_id from student natural join takes; // 自然连接
    name     | course_id
-------------+-----------
 hanjialiang | cs-101
 hanjialiang | cs-347
 xuebichao   | cs-101
 xiayiyou    | cs-190
(4 行记录) 
dbsysgn=# select name, course_id from student left join takes on student.id = takes.id; // 左连接
    name     | course_id
-------------+-----------
 hanjialiang | cs-101
 hanjialiang | cs-347
 xuebichao   | cs-101
 xiayiyou    | cs-190
(4 行记录)
dbsysgn=# select name, course_id from student right join takes on student.id = takes.id; // 右连接
    name     | course_id
-------------+-----------
 hanjialiang | cs-101
 hanjialiang | cs-347
 xuebichao   | cs-101
 xiayiyou    | cs-190
(4 行记录)

dbsysgn=# select name, title from student natural join takes, course where takes.course_id = course.course_id;
   name   |           title
----------+----------------------------
 Zhang    | Intro. to Computer Science
 Zhang    | Database System Concepts
 Shankar  | Intro. to Computer Science
 Shankar  | Game Design
 Shankar  | Robotics
 Shankar  | Database System Concepts
 Brandt   | World History
 Chavez   | Investment Banking
 Peltier  | Physical Principles
 Levy     | Intro. to Computer Science
 Levy     | Intro. to Computer Science
 Levy     | Image Processing
 Williams | Intro. to Computer Science
 Williams | Game Design
 Sanchez  | Music Video Production
 Brown    | Intro. to Computer Science
 Brown    | Image Processing
 Aoi      | Intro. to Digital Systems
 Bourikas | Intro. to Computer Science
 Bourikas | Robotics
 Tanaka   | Intro. to Biology
 Tanaka   | Genetics
(22 行记录)
```
`join...using`
### 4.1.2
`join...on`
```sql
dbsysgn=# select * from student join takes on student.ID = takes.ID;
  id   |   name   | dept_name  | tot_cred |  id   | course_id | sec_id | semester | year | grade
-------+----------+------------+----------+-------+-----------+--------+----------+------+-------
 00128 | Zhang    | Comp. Sci. |      102 | 00128 | CS-101    | 1      | Fall     | 2017 | A
 00128 | Zhang    | Comp. Sci. |      102 | 00128 | CS-347    | 1      | Fall     | 2017 | A-
 12345 | Shankar  | Comp. Sci. |       32 | 12345 | CS-101    | 1      | Fall     | 2017 | C
 12345 | Shankar  | Comp. Sci. |       32 | 12345 | CS-190    | 2      | Spring   | 2017 | A
 12345 | Shankar  | Comp. Sci. |       32 | 12345 | CS-315    | 1      | Spring   | 2018 | A
 12345 | Shankar  | Comp. Sci. |       32 | 12345 | CS-347    | 1      | Fall     | 2017 | A
 19991 | Brandt   | History    |       80 | 19991 | HIS-351   | 1      | Spring   | 2018 | B
 23121 | Chavez   | Finance    |      110 | 23121 | FIN-201   | 1      | Spring   | 2018 | C+
 44553 | Peltier  | Physics    |       56 | 44553 | PHY-101   | 1      | Fall     | 2017 | B-
 45678 | Levy     | Physics    |       46 | 45678 | CS-101    | 1      | Fall     | 2017 | F
 45678 | Levy     | Physics    |       46 | 45678 | CS-101    | 1      | Spring   | 2018 | B+
 45678 | Levy     | Physics    |       46 | 45678 | CS-319    | 1      | Spring   | 2018 | B
 54321 | Williams | Comp. Sci. |       54 | 54321 | CS-101    | 1      | Fall     | 2017 | A-
 54321 | Williams | Comp. Sci. |       54 | 54321 | CS-190    | 2      | Spring   | 2017 | B+
 55739 | Sanchez  | Music      |       38 | 55739 | MU-199    | 1      | Spring   | 2018 | A-
 76543 | Brown    | Comp. Sci. |       58 | 76543 | CS-101    | 1      | Fall     | 2017 | A
 76543 | Brown    | Comp. Sci. |       58 | 76543 | CS-319    | 2      | Spring   | 2018 | A
 76653 | Aoi      | Elec. Eng. |       60 | 76653 | EE-181    | 1      | Spring   | 2017 | C
 98765 | Bourikas | Elec. Eng. |       98 | 98765 | CS-101    | 1      | Fall     | 2017 | C-
 98765 | Bourikas | Elec. Eng. |       98 | 98765 | CS-315    | 1      | Spring   | 2018 | B
 98988 | Tanaka   | Biology    |      120 | 98988 | BIO-101   | 1      | Summer   | 2017 | A
 98988 | Tanaka   | Biology    |      120 | 98988 | BIO-301   | 1      | Summer   | 2018 |
(22 行记录)
dbsysgn=# select * from student natural join takes;                 
  id   |   name   | dept_name  | tot_cred | course_id | sec_id | semester | year | grade
-------+----------+------------+----------+-----------+--------+----------+------+-------
 00128 | Zhang    | Comp. Sci. |      102 | CS-101    | 1      | Fall     | 2017 | A
 00128 | Zhang    | Comp. Sci. |      102 | CS-347    | 1      | Fall     | 2017 | A-
 12345 | Shankar  | Comp. Sci. |       32 | CS-101    | 1      | Fall     | 2017 | C
 12345 | Shankar  | Comp. Sci. |       32 | CS-190    | 2      | Spring   | 2017 | A
 12345 | Shankar  | Comp. Sci. |       32 | CS-315    | 1      | Spring   | 2018 | A
 12345 | Shankar  | Comp. Sci. |       32 | CS-347    | 1      | Fall     | 2017 | A
 19991 | Brandt   | History    |       80 | HIS-351   | 1      | Spring   | 2018 | B
 23121 | Chavez   | Finance    |      110 | FIN-201   | 1      | Spring   | 2018 | C+
 44553 | Peltier  | Physics    |       56 | PHY-101   | 1      | Fall     | 2017 | B-
 45678 | Levy     | Physics    |       46 | CS-101    | 1      | Fall     | 2017 | F
 45678 | Levy     | Physics    |       46 | CS-101    | 1      | Spring   | 2018 | B+
 45678 | Levy     | Physics    |       46 | CS-319    | 1      | Spring   | 2018 | B
 54321 | Williams | Comp. Sci. |       54 | CS-101    | 1      | Fall     | 2017 | A-
 54321 | Williams | Comp. Sci. |       54 | CS-190    | 2      | Spring   | 2017 | B+
 55739 | Sanchez  | Music      |       38 | MU-199    | 1      | Spring   | 2018 | A-
 76543 | Brown    | Comp. Sci. |       58 | CS-101    | 1      | Fall     | 2017 | A
 76543 | Brown    | Comp. Sci. |       58 | CS-319    | 2      | Spring   | 2018 | A
 76653 | Aoi      | Elec. Eng. |       60 | EE-181    | 1      | Spring   | 2017 | C
 98765 | Bourikas | Elec. Eng. |       98 | CS-101    | 1      | Fall     | 2017 | C-
 98765 | Bourikas | Elec. Eng. |       98 | CS-315    | 1      | Spring   | 2018 | B
 98988 | Tanaka   | Biology    |      120 | BIO-101   | 1      | Summer   | 2017 | A
 98988 | Tanaka   | Biology    |      120 | BIO-301   | 1      | Summer   | 2018 |
(22 行记录)
```
### 4.1.3 外连接
`内连接`：之前那种不包括未被连接的连接方式叫做内连接。\
`外连接`： 即使没有匹配的部分也会被展示出来。 \
左外\
右外\
全外\
```sql
dbsysgn=# select * from student natural left join takes;
  id   |   name   | dept_name  | tot_cred | course_id | sec_id | semester | year | grade
-------+----------+------------+----------+-----------+--------+----------+------+-------
 00128 | Zhang    | Comp. Sci. |      102 | CS-101    | 1      | Fall     | 2017 | A
 00128 | Zhang    | Comp. Sci. |      102 | CS-347    | 1      | Fall     | 2017 | A-
 12345 | Shankar  | Comp. Sci. |       32 | CS-101    | 1      | Fall     | 2017 | C
 12345 | Shankar  | Comp. Sci. |       32 | CS-190    | 2      | Spring   | 2017 | A
 12345 | Shankar  | Comp. Sci. |       32 | CS-315    | 1      | Spring   | 2018 | A
 12345 | Shankar  | Comp. Sci. |       32 | CS-347    | 1      | Fall     | 2017 | A
 19991 | Brandt   | History    |       80 | HIS-351   | 1      | Spring   | 2018 | B
 23121 | Chavez   | Finance    |      110 | FIN-201   | 1      | Spring   | 2018 | C+
 44553 | Peltier  | Physics    |       56 | PHY-101   | 1      | Fall     | 2017 | B-
 45678 | Levy     | Physics    |       46 | CS-101    | 1      | Fall     | 2017 | F
 45678 | Levy     | Physics    |       46 | CS-101    | 1      | Spring   | 2018 | B+
 45678 | Levy     | Physics    |       46 | CS-319    | 1      | Spring   | 2018 | B
 54321 | Williams | Comp. Sci. |       54 | CS-101    | 1      | Fall     | 2017 | A-
 54321 | Williams | Comp. Sci. |       54 | CS-190    | 2      | Spring   | 2017 | B+
 55739 | Sanchez  | Music      |       38 | MU-199    | 1      | Spring   | 2018 | A-
 76543 | Brown    | Comp. Sci. |       58 | CS-101    | 1      | Fall     | 2017 | A
 76543 | Brown    | Comp. Sci. |       58 | CS-319    | 2      | Spring   | 2018 | A
 76653 | Aoi      | Elec. Eng. |       60 | EE-181    | 1      | Spring   | 2017 | C
 98765 | Bourikas | Elec. Eng. |       98 | CS-101    | 1      | Fall     | 2017 | C-
 98765 | Bourikas | Elec. Eng. |       98 | CS-315    | 1      | Spring   | 2018 | B
 98988 | Tanaka   | Biology    |      120 | BIO-101   | 1      | Summer   | 2017 | A
 98988 | Tanaka   | Biology    |      120 | BIO-301   | 1      | Summer   | 2018 |
 70557 | Snow     | Physics    |        0 |           |        |          |      |
(23 行记录)
dbsysgn=# select * from student natural left join takes where course_id is null;
  id   | name | dept_name | tot_cred | course_id | sec_id | semester | year | grade
-------+------+-----------+----------+-----------+--------+----------+------+-------
 70557 | Snow | Physics   |        0 |           |        |          |      |
(1 行记录)
dbsysgn=# select * from takes natural right join student;                       
  id   | course_id | sec_id | semester | year | grade |   name   | dept_name  | tot_cred
-------+-----------+--------+----------+------+-------+----------+------------+----------
 00128 | CS-101    | 1      | Fall     | 2017 | A     | Zhang    | Comp. Sci. |      102
 00128 | CS-347    | 1      | Fall     | 2017 | A-    | Zhang    | Comp. Sci. |      102
 12345 | CS-101    | 1      | Fall     | 2017 | C     | Shankar  | Comp. Sci. |       32
 12345 | CS-190    | 2      | Spring   | 2017 | A     | Shankar  | Comp. Sci. |       32
 12345 | CS-315    | 1      | Spring   | 2018 | A     | Shankar  | Comp. Sci. |       32
 12345 | CS-347    | 1      | Fall     | 2017 | A     | Shankar  | Comp. Sci. |       32
 19991 | HIS-351   | 1      | Spring   | 2018 | B     | Brandt   | History    |       80
 23121 | FIN-201   | 1      | Spring   | 2018 | C+    | Chavez   | Finance    |      110
 44553 | PHY-101   | 1      | Fall     | 2017 | B-    | Peltier  | Physics    |       56
 45678 | CS-101    | 1      | Fall     | 2017 | F     | Levy     | Physics    |       46
 45678 | CS-101    | 1      | Spring   | 2018 | B+    | Levy     | Physics    |       46
 45678 | CS-319    | 1      | Spring   | 2018 | B     | Levy     | Physics    |       46
 54321 | CS-101    | 1      | Fall     | 2017 | A-    | Williams | Comp. Sci. |       54
 54321 | CS-190    | 2      | Spring   | 2017 | B+    | Williams | Comp. Sci. |       54
 55739 | MU-199    | 1      | Spring   | 2018 | A-    | Sanchez  | Music      |       38
 76543 | CS-101    | 1      | Fall     | 2017 | A     | Brown    | Comp. Sci. |       58
 76543 | CS-319    | 2      | Spring   | 2018 | A     | Brown    | Comp. Sci. |       58
 76653 | EE-181    | 1      | Spring   | 2017 | C     | Aoi      | Elec. Eng. |       60
 98765 | CS-101    | 1      | Fall     | 2017 | C-    | Bourikas | Elec. Eng. |       98
 98765 | CS-315    | 1      | Spring   | 2018 | B     | Bourikas | Elec. Eng. |       98
 98988 | BIO-101   | 1      | Summer   | 2017 | A     | Tanaka   | Biology    |      120
 98988 | BIO-301   | 1      | Summer   | 2018 |       | Tanaka   | Biology    |      120
 70557 |           |        |          |      |       | Snow     | Physics    |        0
(23 行记录)
dbsysgn=# select * from (select * from student where dept_name = 'Comp. Sci.')natural full outer join (select * from takes where semester = 'Spring' and year = 2017);
  id   |   name   | dept_name  | tot_cred | course_id | sec_id | semester | year | grade
-------+----------+------------+----------+-----------+--------+----------+------+-------
 12345 | Shankar  | Comp. Sci. |       32 | CS-190    | 2      | Spring   | 2017 | A
 54321 | Williams | Comp. Sci. |       54 | CS-190    | 2      | Spring   | 2017 | B+
 76653 |          |            |          | EE-181    | 1      | Spring   | 2017 | C
 00128 | Zhang    | Comp. Sci. |      102 |           |        |          |      |
 76543 | Brown    | Comp. Sci. |       58 |           |        |          |      |
(5 行记录)
```
### 4.1.4 连接类型和条件
`内连接` \
`join...using` \
`natural join...using`\
`inner join...using` \
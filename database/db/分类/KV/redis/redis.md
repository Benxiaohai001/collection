# 高可用方案
## 主从复制
* 原理
一个主节点负责写，多个从节点负责读，异步复制主节点的数据，实现读写分离。
* 优点
    * 简单部署，适合读多写少的场景
    * 数据备份和负载均衡能力
* 缺点
    * 主节点故障需要手动切换从节点，无法自动容灾；
    * 单主节点存在瓶颈，拓展性有限
* 使用场景
    * 开发测试、小规模应用或者作为其他高可用方案的基础架构
## 哨兵模式(sentinel)
* 原理
通过`sentinel`节点集群监控`redis`主从节点，实现自动故障检测与切换。当主节点宕机时，`sentinel`通过投票选举新的主节点，并通知客户端更新链接。
* 核心功能
    * 监控：定期检查节点健康状态。
    * 自动故障转移：主节点故障时触发切换；
    * 通知：通过发布订阅机制更换客户端配置。
* 优点
    * 实现高可用，支持自动故障转移
    * 配置相对简单，适合中小规模应用；
* 缺点
    * 数据分片不支持，需要客户端兼容sentinel
    * 切换期间可能出现短暂服务中断（通常几秒）
* 最小部署
1主2从 + 3 sentinel节点（推荐奇数节点保证选举）。
## redis集群（cluster）
* 原理
官方分布式方案，通过分片（sharding）将数据分散到多个节点，每个主节点负责16384个哈希槽，支持自动数据迁移和故障转移。
* 核心特性
    * 水平拓展：支持动态添加节点，拓展至上千节点。
    * 高可用性：每个主节点有从节点，主故障时从节点自动提升；
    * 去中心化架构： 节点通过gossip协议通信，无单节点故障。
* 优点
    * 支持大规模数据和高并发；
    * 自动故障转移与数据均衡；
* 缺点
    * 配置复杂，需客户端支持集群协议；
    * 跨槽操作需要使用哈希标签（hash tag）
* 最小部署
3主3从（每主一从）
## 第三代理方案
1. codis、twemproxy
    1. 原理 通过代理层实现数据分片，客户端链接代理而非直接操作redis；
    2. 优点
        1. 兼容旧版本redis，无序更改客户端；
        2. 提供可视化管理和动态扩容；
    3. 缺点
        1. 增加代理层可能引出新的性能损耗
2. zookeeper集成
    1. 原理：结合zookeeper管理节点状态，实现故障切换和配置同步；
    2. 适用场景：与现有zookeeper生态集成的复杂环境配置；